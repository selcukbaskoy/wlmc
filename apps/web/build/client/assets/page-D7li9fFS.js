import{C as r}from"./PolymorphicComponent-9_vSQL7O.js";import{r as f,o as e,w as S,G as z}from"./chunk-PVWAREVJ-D_rE8Vsp.js";import{u as D,R as T}from"./layout-DOAopD-I.js";import{a as E,A as O}from"./layout-AkPwuKQJ.js";import{u as F,U as P}from"./useUpload-D18CvZdz.js";import{u as N}from"./useQuery-CqtvtKZW.js";import{u as w}from"./useMutation-CH2wPccM.js";import{A}from"./arrow-left-Cv6H1si6.js";import{E as U}from"./eye-DY26Yb9t.js";import{c as L}from"./createLucideIcon-CYD35-38.js";import{T as M,S as q}from"./tag-CPjndOyy.js";import{G}from"./globe-DOF7cSF5.js";import{X as B}from"./x-Cg9-vnoo.js";import"./react-CGZJyOp0.js";import"./file-text-Dl61NW4K.js";import"./circle-help-BCyQsvte.js";import"./users-BGaJEnan.js";import"./menu-CpMGlG8b.js";if(typeof window<"u"){const u={};globalThis.process??={};const n=globalThis.process.env??{};globalThis.process.env=new Proxy(Object.assign({},u,n),{get(s,o){return o in s?s[o]:void 0},has(){return!0}})}const K=L("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);if(typeof window<"u"){const u={};globalThis.process??={};const n=globalThis.process.env??{};globalThis.process.env=new Proxy(Object.assign({},u,n),{get(s,o){return o in s?s[o]:void 0},has(){return!0}})}function $({value:u,onChange:n,label:s}){const[o,{loading:m}]=F(),[g,x]=f.useState(!1),p=async i=>{try{const c=await o({reactNativeAsset:i});if(c.error){alert("Upload failed: "+c.error);return}n(c.url)}catch{alert("Upload failed")}},h=i=>{i.preventDefault(),x(!1);const c=i.dataTransfer.files;c.length>0&&p(c[0])},d=i=>{i.preventDefault(),x(!0)},y=i=>{i.preventDefault(),x(!1)};return e.jsxs(r,{renderId:"render-d5f0098f",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700 mb-2",renderId:"render-887e2606",as:"label",children:s}),e.jsx(r,{className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${g?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDrop:h,onDragOver:d,onDragLeave:y,renderId:"render-e7b68e71",as:"div",children:u?e.jsxs(r,{className:"relative",renderId:"render-ae272bad",as:"div",children:[e.jsx(r,{src:u,alt:"Preview",className:"max-w-full h-32 object-cover mx-auto rounded",renderId:"render-5ef9dfc8",as:"img"}),e.jsx(r,{type:"button",onClick:()=>n(""),className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",renderId:"render-cbf51a23",as:"button",children:e.jsx(B,{size:16})})]}):e.jsxs(r,{renderId:"render-eabb72d8",as:"div",children:[e.jsx(P,{size:48,className:"mx-auto text-gray-400 mb-4"}),e.jsx(r,{className:"text-sm text-gray-600 mb-2",renderId:"render-a1ca10a3",as:"p",children:"Dosyayı sürükleyin veya tıklayarak seçin"}),e.jsx(r,{type:"file",accept:"image/*",onChange:i=>{const c=i.target.files?.[0];c&&p(c)},className:"hidden",id:"file-upload",renderId:"render-8b44000c",as:"input"}),e.jsx(r,{htmlFor:"file-upload",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 cursor-pointer",renderId:"render-f9a6a116",as:"label",children:m?"Yükleniyor...":"Dosya Seç"})]})})]})}function R({params:u}){const{id:n}=u,[s,o]=f.useState({content_type:"blog_post",title:"",slug:"",body:"",summary:"",cover_image:"",status:"draft",publish_at:"",unpublish_at:"",meta_title:"",meta_description:"",canonical:"",og_image:"",categories:[],tags:[]}),[m,g]=f.useState({}),[x,p]=f.useState(!1),h=D(),{data:d,loading:y,error:i}=N({queryKey:["admin-content",n],queryFn:async()=>{const a=await fetch(`/api/admin/content/${n}`);if(!a.ok)throw new Error("Failed to fetch content");return a.json()}}),{data:c}=N({queryKey:["admin-categories"],queryFn:async()=>{const a=await fetch("/api/admin/categories");if(!a.ok)throw new Error("Failed to fetch categories");return a.json()}}),{data:k}=N({queryKey:["admin-tags"],queryFn:async()=>{const a=await fetch("/api/admin/tags");if(!a.ok)throw new Error("Failed to fetch tags");return a.json()}});f.useEffect(()=>{d&&o({content_type:d.content_type,title:d.title||"",slug:d.slug||"",body:d.body||"",summary:d.summary||"",cover_image:d.cover_image||"",status:d.status||"draft",publish_at:d.publish_at?new Date(d.publish_at).toISOString().slice(0,16):"",unpublish_at:d.unpublish_at?new Date(d.unpublish_at).toISOString().slice(0,16):"",meta_title:d.meta_title||"",meta_description:d.meta_description||"",canonical:d.canonical||"",og_image:d.og_image||"",categories:d.categories?.map(a=>a.id)||[],tags:d.tags?.map(a=>a.id)||[]})},[d]);const j=w({mutationFn:async a=>{const l=await fetch(`/api/admin/content/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!l.ok){const b=await l.json();throw new Error(b.error||"Failed to update content")}return l.json()},onSuccess:()=>{h.invalidateQueries(["admin-content"]),window.location.href="/admin/content/blog"},onError:a=>{g({general:a.message})}}),v=w({mutationFn:async()=>{const a=await fetch("/api/admin/preview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content_id:n})});if(!a.ok)throw new Error("Failed to create preview");return a.json()},onSuccess:a=>{window.open(a.preview_url,"_blank")}}),t=(a,l)=>{o(b=>({...b,[a]:l})),a==="slug"&&p(!1),m[a]&&g(b=>({...b,[a]:null}))},_=a=>{a.preventDefault();const l={};if(s.title||(l.title="Başlık zorunludur"),s.body||(l.body="İçerik zorunludur"),Object.keys(l).length>0){g(l);return}j.mutate(s)},C=()=>{v.mutate()};return y?e.jsx(r,{className:"flex items-center justify-center py-12",renderId:"render-42489265",as:"div",children:e.jsx(r,{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600",renderId:"render-c3837ea9",as:"div"})}):i?e.jsx(r,{className:"bg-red-50 border border-red-200 rounded-lg p-4",renderId:"render-43b72e07",as:"div",children:e.jsxs(r,{className:"text-red-600",renderId:"render-15933764",as:"p",children:["Bir hata oluştu: ",i.message]})}):e.jsxs(r,{className:"max-w-4xl mx-auto space-y-6",renderId:"render-da16b530",as:"div",children:[e.jsxs(r,{className:"flex items-center justify-between",renderId:"render-af697591",as:"div",children:[e.jsxs(r,{className:"flex items-center space-x-4",renderId:"render-8dd92184",as:"div",children:[e.jsx(r,{onClick:()=>window.location.href="/admin/content/blog",className:"text-gray-600 hover:text-gray-900",renderId:"render-6907220c",as:"button",children:e.jsx(A,{size:24})}),e.jsxs(r,{renderId:"render-be5f4ea4",as:"div",children:[e.jsx(r,{className:"text-2xl font-bold text-gray-900",renderId:"render-01781df1",as:"h1",children:"Blog Yazısını Düzenle"}),e.jsxs(r,{className:"text-gray-600",renderId:"render-865fb260",as:"p",children:[d?.title," - Versiyon ",d?.version]})]})]}),e.jsxs(r,{className:"flex items-center space-x-3",renderId:"render-79a7f9bc",as:"div",children:[e.jsxs(r,{type:"button",onClick:C,disabled:v.loading,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",renderId:"render-9870068d",as:"button",children:[e.jsx(U,{size:16,className:"mr-2"}),v.loading?"Hazırlanıyor...":"Önizle"]}),e.jsxs(r,{onClick:()=>window.location.href=`/admin/content/blog/versions/${n}`,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",renderId:"render-2377eccc",as:"button",children:[e.jsx(K,{size:16,className:"mr-2"}),"Geçmiş"]})]})]}),e.jsx(r,{onSubmit:_,className:"space-y-6",renderId:"render-621d34e1",as:"form",children:e.jsxs(r,{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",renderId:"render-e071d62d",as:"div",children:[e.jsx(r,{className:"lg:col-span-2 space-y-6",renderId:"render-efaa0c8a",as:"div",children:e.jsxs(r,{className:"bg-white rounded-lg border border-gray-200 p-6",renderId:"render-23055fd1",as:"div",children:[e.jsxs(r,{className:"mb-6",renderId:"render-29af9d9c",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700 mb-2",renderId:"render-c7b1bab8",as:"label",children:"Başlık *"}),e.jsx(r,{type:"text",value:s.title,onChange:a=>t("title",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Blog yazısı başlığını girin",renderId:"render-4d2cca40",as:"input"}),m.title&&e.jsx(r,{className:"text-red-600 text-sm mt-1",renderId:"render-9e5b28f1",as:"p",children:m.title})]}),e.jsxs(r,{className:"mb-6",renderId:"render-50939d1f",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700 mb-2",renderId:"render-847ff899",as:"label",children:"URL Slug"}),e.jsxs(r,{className:"flex",renderId:"render-a332b682",as:"div",children:[e.jsx(r,{className:"inline-flex items-center px-3 py-2 border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm rounded-l-lg",renderId:"render-6556c1c9",as:"span",children:"/blog/"}),e.jsx(r,{type:"text",value:s.slug,onChange:a=>t("slug",a.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-r-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"url-slug",renderId:"render-458d4f11",as:"input"})]})]}),e.jsxs(r,{className:"mb-6",renderId:"render-c5d150dc",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700 mb-2",renderId:"render-09de4907",as:"label",children:"Özet"}),e.jsx(r,{value:s.summary,onChange:a=>t("summary",a.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Kısa özet yazın",renderId:"render-b07777b2",as:"textarea"})]}),e.jsxs(r,{renderId:"render-a3772559",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700 mb-2",renderId:"render-3105a6d1",as:"label",children:"İçerik *"}),e.jsx(r,{value:s.body,onChange:a=>t("body",a.target.value),rows:15,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm",placeholder:"Markdown formatında içeriğinizi yazın...",renderId:"render-b1672a2d",as:"textarea"}),m.body&&e.jsx(r,{className:"text-red-600 text-sm mt-1",renderId:"render-a33eb416",as:"p",children:m.body}),e.jsx(r,{className:"text-sm text-gray-500 mt-2",renderId:"render-0dbe610a",as:"p",children:"Markdown formatı desteklenir. Örnek: **kalın**, *italik*, [link](url)"})]})]})}),e.jsxs(r,{className:"space-y-6",renderId:"render-3f1b56aa",as:"div",children:[e.jsxs(r,{className:"bg-white rounded-lg border border-gray-200 p-6",renderId:"render-07b572b8",as:"div",children:[e.jsx(r,{className:"text-lg font-medium text-gray-900 mb-4",renderId:"render-7b183b16",as:"h3",children:"Yayın Ayarları"}),e.jsxs(r,{className:"space-y-4",renderId:"render-67fe14dc",as:"div",children:[e.jsxs(r,{renderId:"render-7739f86d",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700 mb-2",renderId:"render-d01fcdec",as:"label",children:"Durum"}),e.jsxs(r,{value:s.status,onChange:a=>t("status",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",renderId:"render-2393af7a",as:"select",children:[e.jsx(r,{value:"draft",renderId:"render-267cc7d8",as:"option",children:"Taslak"}),e.jsx(r,{value:"review",renderId:"render-d5bfc379",as:"option",children:"İnceleme"}),e.jsx(r,{value:"published",renderId:"render-4da3513d",as:"option",children:"Yayında"})]})]}),e.jsxs(r,{renderId:"render-12a8a0ae",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700 mb-2",renderId:"render-e6de2a49",as:"label",children:"Yayın Tarihi"}),e.jsx(r,{type:"datetime-local",value:s.publish_at,onChange:a=>t("publish_at",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",renderId:"render-54fc42c3",as:"input"})]}),e.jsxs(r,{renderId:"render-f4df2951",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700 mb-2",renderId:"render-4b940c03",as:"label",children:"Yayından Kaldırma Tarihi"}),e.jsx(r,{type:"datetime-local",value:s.unpublish_at,onChange:a=>t("unpublish_at",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",renderId:"render-277de278",as:"input"})]})]})]}),e.jsx(r,{className:"bg-white rounded-lg border border-gray-200 p-6",renderId:"render-016ef48d",as:"div",children:e.jsx($,{label:"Kapak Görseli",value:s.cover_image,onChange:a=>t("cover_image",a)})}),e.jsxs(r,{className:"bg-white rounded-lg border border-gray-200 p-6",renderId:"render-545640a2",as:"div",children:[e.jsxs(r,{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",renderId:"render-cf1c5bd2",as:"h3",children:[e.jsx(E,{size:20,className:"mr-2"}),"Kategoriler"]}),e.jsx(r,{className:"space-y-2 max-h-48 overflow-y-auto",renderId:"render-5f982a52",as:"div",children:c?.map(a=>e.jsxs(r,{className:"flex items-center",renderId:"render-4388f69d",as:"label",children:[e.jsx(r,{type:"checkbox",checked:s.categories.includes(a.id),onChange:l=>{const b=l.target.checked?[...s.categories,a.id]:s.categories.filter(I=>I!==a.id);t("categories",b)},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500",renderId:"render-5286a9e5",as:"input"}),e.jsx(r,{className:"ml-2 text-sm text-gray-700",renderId:"render-e40dd0da",as:"span",children:a.name})]},a.id))})]}),e.jsxs(r,{className:"bg-white rounded-lg border border-gray-200 p-6",renderId:"render-ea610d55",as:"div",children:[e.jsxs(r,{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",renderId:"render-fa411c4e",as:"h3",children:[e.jsx(M,{size:20,className:"mr-2"}),"Etiketler"]}),e.jsx(r,{className:"space-y-2 max-h-48 overflow-y-auto",renderId:"render-b97c33fb",as:"div",children:k?.map(a=>e.jsxs(r,{className:"flex items-center",renderId:"render-8f22b3bb",as:"label",children:[e.jsx(r,{type:"checkbox",checked:s.tags.includes(a.id),onChange:l=>{const b=l.target.checked?[...s.tags,a.id]:s.tags.filter(I=>I!==a.id);t("tags",b)},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500",renderId:"render-67db20d8",as:"input"}),e.jsx(r,{className:"ml-2 text-sm text-gray-700",renderId:"render-b8e99889",as:"span",children:a.name})]},a.id))})]}),e.jsxs(r,{className:"bg-white rounded-lg border border-gray-200 p-6",renderId:"render-dd1d20fa",as:"div",children:[e.jsxs(r,{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",renderId:"render-857a7911",as:"h3",children:[e.jsx(G,{size:20,className:"mr-2"}),"SEO Ayarları"]}),e.jsxs(r,{className:"space-y-4",renderId:"render-8cee69ba",as:"div",children:[e.jsxs(r,{renderId:"render-3349774f",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700 mb-2",renderId:"render-601f259c",as:"label",children:"Meta Başlık"}),e.jsx(r,{type:"text",value:s.meta_title,onChange:a=>t("meta_title",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"SEO başlığı",renderId:"render-d1db3dc8",as:"input"})]}),e.jsxs(r,{renderId:"render-e70b433d",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700 mb-2",renderId:"render-518c47b4",as:"label",children:"Meta Açıklama"}),e.jsx(r,{value:s.meta_description,onChange:a=>t("meta_description",a.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"SEO açıklaması",renderId:"render-ed07053a",as:"textarea"})]}),e.jsxs(r,{renderId:"render-d01b2987",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700 mb-2",renderId:"render-e15fecb4",as:"label",children:"Canonical URL"}),e.jsx(r,{type:"url",value:s.canonical,onChange:a=>t("canonical",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://example.com/canonical-url",renderId:"render-8420cd1a",as:"input"})]}),e.jsxs(r,{renderId:"render-d677bc66",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700 mb-2",renderId:"render-67e090ba",as:"label",children:"OG Image URL"}),e.jsx(r,{type:"url",value:s.og_image,onChange:a=>t("og_image",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://example.com/og-image.jpg",renderId:"render-3305dcd9",as:"input"})]})]})]}),e.jsxs(r,{className:"bg-white rounded-lg border border-gray-200 p-6",renderId:"render-2304a114",as:"div",children:[m.general&&e.jsx(r,{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",renderId:"render-dd68857e",as:"div",children:e.jsx(r,{className:"text-red-600 text-sm",renderId:"render-eef83c42",as:"p",children:m.general})}),e.jsx(r,{className:"space-y-3",renderId:"render-906f57cc",as:"div",children:e.jsxs(r,{type:"submit",disabled:j.loading,className:"w-full inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",renderId:"render-5ecb4755",as:"button",children:[e.jsx(q,{size:16,className:"mr-2"}),j.loading?"Güncelleniyor...":"Güncelle"]})})]})]})]})})]})}if(typeof window<"u"){const u={};globalThis.process??={};const n=globalThis.process.env??{};globalThis.process.env=new Proxy(Object.assign({},u,n),{get(s,o){return o in s?s[o]:void 0},has(){return!0}})}const ce=S(function(n){const s=z();return e.jsx(T,{children:e.jsx(O,{children:e.jsx(R,{...n,id:s.id})})})});export{ce as default};
