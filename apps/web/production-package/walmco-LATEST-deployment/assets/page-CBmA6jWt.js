import{C as r}from"./PolymorphicComponent-9_vSQL7O.js";import{r as x,o as e,w as S,G as z}from"./chunk-PVWAREVJ-D_rE8Vsp.js";import{u as D,R as T}from"./layout-CWBhClkj.js";import{a as E,A as O}from"./layout-CHOcBlHj.js";import{u as F,U as P}from"./useUpload-D18CvZdz.js";import{u as N}from"./useQuery-hlGAr2h6.js";import{u as w}from"./useMutation-CJHwtqFu.js";import{A}from"./arrow-left-Cv6H1si6.js";import{E as U}from"./eye-DY26Yb9t.js";import{c as L}from"./createLucideIcon-CYD35-38.js";import{T as M,S as q}from"./tag-CPjndOyy.js";import{G}from"./globe-DOF7cSF5.js";import{X as B}from"./x-Cg9-vnoo.js";import"./react-CGZJyOp0.js";import"./file-text-Dl61NW4K.js";import"./circle-help-BCyQsvte.js";import"./users-BGaJEnan.js";import"./menu-CpMGlG8b.js";if(typeof window<"u"){const u={};globalThis.process??={};const n=globalThis.process.env??{};globalThis.process.env=new Proxy(Object.assign({},u,n),{get(s,o){return o in s?s[o]:void 0},has(){return!0}})}const K=L("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);if(typeof window<"u"){const u={};globalThis.process??={};const n=globalThis.process.env??{};globalThis.process.env=new Proxy(Object.assign({},u,n),{get(s,o){return o in s?s[o]:void 0},has(){return!0}})}function $({value:u,onChange:n,label:s}){const[o,{loading:m}]=F(),[g,f]=x.useState(!1),p=async i=>{try{const c=await o({reactNativeAsset:i});if(c.error){alert("Upload failed: "+c.error);return}n(c.url)}catch{alert("Upload failed")}},h=i=>{i.preventDefault(),f(!1);const c=i.dataTransfer.files;c.length>0&&p(c[0])},d=i=>{i.preventDefault(),f(!0)},y=i=>{i.preventDefault(),f(!1)};return e.jsxs(r,{renderId:"render-eedfd1f6",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700 mb-2",renderId:"render-05bc3982",as:"label",children:s}),e.jsx(r,{className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${g?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDrop:h,onDragOver:d,onDragLeave:y,renderId:"render-d3371a79",as:"div",children:u?e.jsxs(r,{className:"relative",renderId:"render-2ab5320c",as:"div",children:[e.jsx(r,{src:u,alt:"Preview",className:"max-w-full h-32 object-cover mx-auto rounded",renderId:"render-0563e5b5",as:"img"}),e.jsx(r,{type:"button",onClick:()=>n(""),className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",renderId:"render-44c2792b",as:"button",children:e.jsx(B,{size:16})})]}):e.jsxs(r,{renderId:"render-f1920dde",as:"div",children:[e.jsx(P,{size:48,className:"mx-auto text-gray-400 mb-4"}),e.jsx(r,{className:"text-sm text-gray-600 mb-2",renderId:"render-4503e12c",as:"p",children:"Dosyayı sürükleyin veya tıklayarak seçin"}),e.jsx(r,{type:"file",accept:"image/*",onChange:i=>{const c=i.target.files?.[0];c&&p(c)},className:"hidden",id:"file-upload",renderId:"render-28e87c5d",as:"input"}),e.jsx(r,{htmlFor:"file-upload",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 cursor-pointer",renderId:"render-f9b25510",as:"label",children:m?"Yükleniyor...":"Dosya Seç"})]})})]})}function R({params:u}){const{id:n}=u,[s,o]=x.useState({content_type:"blog_post",title:"",slug:"",body:"",summary:"",cover_image:"",status:"draft",publish_at:"",unpublish_at:"",meta_title:"",meta_description:"",canonical:"",og_image:"",categories:[],tags:[]}),[m,g]=x.useState({}),[f,p]=x.useState(!1),h=D(),{data:d,loading:y,error:i}=N({queryKey:["admin-content",n],queryFn:async()=>{const a=await fetch(`/api/admin/content/${n}`);if(!a.ok)throw new Error("Failed to fetch content");return a.json()}}),{data:c}=N({queryKey:["admin-categories"],queryFn:async()=>{const a=await fetch("/api/admin/categories");if(!a.ok)throw new Error("Failed to fetch categories");return a.json()}}),{data:k}=N({queryKey:["admin-tags"],queryFn:async()=>{const a=await fetch("/api/admin/tags");if(!a.ok)throw new Error("Failed to fetch tags");return a.json()}});x.useEffect(()=>{d&&o({content_type:d.content_type,title:d.title||"",slug:d.slug||"",body:d.body||"",summary:d.summary||"",cover_image:d.cover_image||"",status:d.status||"draft",publish_at:d.publish_at?new Date(d.publish_at).toISOString().slice(0,16):"",unpublish_at:d.unpublish_at?new Date(d.unpublish_at).toISOString().slice(0,16):"",meta_title:d.meta_title||"",meta_description:d.meta_description||"",canonical:d.canonical||"",og_image:d.og_image||"",categories:d.categories?.map(a=>a.id)||[],tags:d.tags?.map(a=>a.id)||[]})},[d]);const j=w({mutationFn:async a=>{const l=await fetch(`/api/admin/content/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!l.ok){const b=await l.json();throw new Error(b.error||"Failed to update content")}return l.json()},onSuccess:()=>{h.invalidateQueries(["admin-content"]),window.location.href="/admin/content/blog"},onError:a=>{g({general:a.message})}}),v=w({mutationFn:async()=>{const a=await fetch("/api/admin/preview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content_id:n})});if(!a.ok)throw new Error("Failed to create preview");return a.json()},onSuccess:a=>{window.open(a.preview_url,"_blank")}}),t=(a,l)=>{o(b=>({...b,[a]:l})),a==="slug"&&p(!1),m[a]&&g(b=>({...b,[a]:null}))},_=a=>{a.preventDefault();const l={};if(s.title||(l.title="Başlık zorunludur"),s.body||(l.body="İçerik zorunludur"),Object.keys(l).length>0){g(l);return}j.mutate(s)},C=()=>{v.mutate()};return y?e.jsx(r,{className:"flex items-center justify-center py-12",renderId:"render-ee99e90e",as:"div",children:e.jsx(r,{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600",renderId:"render-3a5b537a",as:"div"})}):i?e.jsx(r,{className:"bg-red-50 border border-red-200 rounded-lg p-4",renderId:"render-cc4790dc",as:"div",children:e.jsxs(r,{className:"text-red-600",renderId:"render-1485a03f",as:"p",children:["Bir hata oluştu: ",i.message]})}):e.jsxs(r,{className:"max-w-4xl mx-auto space-y-6",renderId:"render-35790daf",as:"div",children:[e.jsxs(r,{className:"flex items-center justify-between",renderId:"render-1865c1ce",as:"div",children:[e.jsxs(r,{className:"flex items-center space-x-4",renderId:"render-e1de8bbb",as:"div",children:[e.jsx(r,{onClick:()=>window.location.href="/admin/content/blog",className:"text-gray-600 hover:text-gray-900",renderId:"render-4f02acb6",as:"button",children:e.jsx(A,{size:24})}),e.jsxs(r,{renderId:"render-4a1ac482",as:"div",children:[e.jsx(r,{className:"text-2xl font-bold text-gray-900",renderId:"render-ed9219c4",as:"h1",children:"Blog Yazısını Düzenle"}),e.jsxs(r,{className:"text-gray-600",renderId:"render-39505c07",as:"p",children:[d?.title," - Versiyon ",d?.version]})]})]}),e.jsxs(r,{className:"flex items-center space-x-3",renderId:"render-9c93be8d",as:"div",children:[e.jsxs(r,{type:"button",onClick:C,disabled:v.loading,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",renderId:"render-366ea093",as:"button",children:[e.jsx(U,{size:16,className:"mr-2"}),v.loading?"Hazırlanıyor...":"Önizle"]}),e.jsxs(r,{onClick:()=>window.location.href=`/admin/content/blog/versions/${n}`,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",renderId:"render-eb8c19bd",as:"button",children:[e.jsx(K,{size:16,className:"mr-2"}),"Geçmiş"]})]})]}),e.jsx(r,{onSubmit:_,className:"space-y-6",renderId:"render-d7dededc",as:"form",children:e.jsxs(r,{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",renderId:"render-bffd069e",as:"div",children:[e.jsx(r,{className:"lg:col-span-2 space-y-6",renderId:"render-091ccdf3",as:"div",children:e.jsxs(r,{className:"bg-white rounded-lg border border-gray-200 p-6",renderId:"render-2855dd10",as:"div",children:[e.jsxs(r,{className:"mb-6",renderId:"render-8137d1da",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700 mb-2",renderId:"render-c805a802",as:"label",children:"Başlık *"}),e.jsx(r,{type:"text",value:s.title,onChange:a=>t("title",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Blog yazısı başlığını girin",renderId:"render-b66a206f",as:"input"}),m.title&&e.jsx(r,{className:"text-red-600 text-sm mt-1",renderId:"render-5bb9a3c6",as:"p",children:m.title})]}),e.jsxs(r,{className:"mb-6",renderId:"render-fe9bde0c",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700 mb-2",renderId:"render-b6b2cc40",as:"label",children:"URL Slug"}),e.jsxs(r,{className:"flex",renderId:"render-3ab40124",as:"div",children:[e.jsx(r,{className:"inline-flex items-center px-3 py-2 border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm rounded-l-lg",renderId:"render-74150342",as:"span",children:"/blog/"}),e.jsx(r,{type:"text",value:s.slug,onChange:a=>t("slug",a.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-r-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"url-slug",renderId:"render-c43deab2",as:"input"})]})]}),e.jsxs(r,{className:"mb-6",renderId:"render-379c83bf",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700 mb-2",renderId:"render-150e9a21",as:"label",children:"Özet"}),e.jsx(r,{value:s.summary,onChange:a=>t("summary",a.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Kısa özet yazın",renderId:"render-d2be91c4",as:"textarea"})]}),e.jsxs(r,{renderId:"render-631e8bd4",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700 mb-2",renderId:"render-70ed4d9f",as:"label",children:"İçerik *"}),e.jsx(r,{value:s.body,onChange:a=>t("body",a.target.value),rows:15,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm",placeholder:"Markdown formatında içeriğinizi yazın...",renderId:"render-900cd671",as:"textarea"}),m.body&&e.jsx(r,{className:"text-red-600 text-sm mt-1",renderId:"render-fc20b88f",as:"p",children:m.body}),e.jsx(r,{className:"text-sm text-gray-500 mt-2",renderId:"render-18a51173",as:"p",children:"Markdown formatı desteklenir. Örnek: **kalın**, *italik*, [link](url)"})]})]})}),e.jsxs(r,{className:"space-y-6",renderId:"render-6dfb733e",as:"div",children:[e.jsxs(r,{className:"bg-white rounded-lg border border-gray-200 p-6",renderId:"render-9017337b",as:"div",children:[e.jsx(r,{className:"text-lg font-medium text-gray-900 mb-4",renderId:"render-a1089b86",as:"h3",children:"Yayın Ayarları"}),e.jsxs(r,{className:"space-y-4",renderId:"render-71b0c3fe",as:"div",children:[e.jsxs(r,{renderId:"render-cec858ec",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700 mb-2",renderId:"render-6974cad1",as:"label",children:"Durum"}),e.jsxs(r,{value:s.status,onChange:a=>t("status",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",renderId:"render-5877ac1a",as:"select",children:[e.jsx(r,{value:"draft",renderId:"render-a84ff549",as:"option",children:"Taslak"}),e.jsx(r,{value:"review",renderId:"render-b87df3d8",as:"option",children:"İnceleme"}),e.jsx(r,{value:"published",renderId:"render-f186d7fb",as:"option",children:"Yayında"})]})]}),e.jsxs(r,{renderId:"render-f0adf553",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700 mb-2",renderId:"render-8fd3bc0a",as:"label",children:"Yayın Tarihi"}),e.jsx(r,{type:"datetime-local",value:s.publish_at,onChange:a=>t("publish_at",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",renderId:"render-8016d87c",as:"input"})]}),e.jsxs(r,{renderId:"render-910d96d3",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700 mb-2",renderId:"render-34713eac",as:"label",children:"Yayından Kaldırma Tarihi"}),e.jsx(r,{type:"datetime-local",value:s.unpublish_at,onChange:a=>t("unpublish_at",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",renderId:"render-e377c7c9",as:"input"})]})]})]}),e.jsx(r,{className:"bg-white rounded-lg border border-gray-200 p-6",renderId:"render-a28f952a",as:"div",children:e.jsx($,{label:"Kapak Görseli",value:s.cover_image,onChange:a=>t("cover_image",a)})}),e.jsxs(r,{className:"bg-white rounded-lg border border-gray-200 p-6",renderId:"render-aa7540b8",as:"div",children:[e.jsxs(r,{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",renderId:"render-c5d10930",as:"h3",children:[e.jsx(E,{size:20,className:"mr-2"}),"Kategoriler"]}),e.jsx(r,{className:"space-y-2 max-h-48 overflow-y-auto",renderId:"render-d0541652",as:"div",children:c?.map(a=>e.jsxs(r,{className:"flex items-center",renderId:"render-47c0d154",as:"label",children:[e.jsx(r,{type:"checkbox",checked:s.categories.includes(a.id),onChange:l=>{const b=l.target.checked?[...s.categories,a.id]:s.categories.filter(I=>I!==a.id);t("categories",b)},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500",renderId:"render-ca287fe1",as:"input"}),e.jsx(r,{className:"ml-2 text-sm text-gray-700",renderId:"render-ee1acb74",as:"span",children:a.name})]},a.id))})]}),e.jsxs(r,{className:"bg-white rounded-lg border border-gray-200 p-6",renderId:"render-027f83ec",as:"div",children:[e.jsxs(r,{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",renderId:"render-eb1de3d4",as:"h3",children:[e.jsx(M,{size:20,className:"mr-2"}),"Etiketler"]}),e.jsx(r,{className:"space-y-2 max-h-48 overflow-y-auto",renderId:"render-e4e4906a",as:"div",children:k?.map(a=>e.jsxs(r,{className:"flex items-center",renderId:"render-abbd4c00",as:"label",children:[e.jsx(r,{type:"checkbox",checked:s.tags.includes(a.id),onChange:l=>{const b=l.target.checked?[...s.tags,a.id]:s.tags.filter(I=>I!==a.id);t("tags",b)},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500",renderId:"render-b01a9042",as:"input"}),e.jsx(r,{className:"ml-2 text-sm text-gray-700",renderId:"render-4073a3eb",as:"span",children:a.name})]},a.id))})]}),e.jsxs(r,{className:"bg-white rounded-lg border border-gray-200 p-6",renderId:"render-30e678ce",as:"div",children:[e.jsxs(r,{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",renderId:"render-69401b4e",as:"h3",children:[e.jsx(G,{size:20,className:"mr-2"}),"SEO Ayarları"]}),e.jsxs(r,{className:"space-y-4",renderId:"render-ca707750",as:"div",children:[e.jsxs(r,{renderId:"render-513ef3b1",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700 mb-2",renderId:"render-fb185ecb",as:"label",children:"Meta Başlık"}),e.jsx(r,{type:"text",value:s.meta_title,onChange:a=>t("meta_title",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"SEO başlığı",renderId:"render-c7b852cb",as:"input"})]}),e.jsxs(r,{renderId:"render-e326a00b",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700 mb-2",renderId:"render-4a6cde71",as:"label",children:"Meta Açıklama"}),e.jsx(r,{value:s.meta_description,onChange:a=>t("meta_description",a.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"SEO açıklaması",renderId:"render-a5707e05",as:"textarea"})]}),e.jsxs(r,{renderId:"render-ce56f2dc",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700 mb-2",renderId:"render-fe1e507c",as:"label",children:"Canonical URL"}),e.jsx(r,{type:"url",value:s.canonical,onChange:a=>t("canonical",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://example.com/canonical-url",renderId:"render-33455252",as:"input"})]}),e.jsxs(r,{renderId:"render-722e8d25",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700 mb-2",renderId:"render-55fabf19",as:"label",children:"OG Image URL"}),e.jsx(r,{type:"url",value:s.og_image,onChange:a=>t("og_image",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://example.com/og-image.jpg",renderId:"render-d8093c6c",as:"input"})]})]})]}),e.jsxs(r,{className:"bg-white rounded-lg border border-gray-200 p-6",renderId:"render-7700194e",as:"div",children:[m.general&&e.jsx(r,{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",renderId:"render-fc4613ba",as:"div",children:e.jsx(r,{className:"text-red-600 text-sm",renderId:"render-029050d6",as:"p",children:m.general})}),e.jsx(r,{className:"space-y-3",renderId:"render-f9e00741",as:"div",children:e.jsxs(r,{type:"submit",disabled:j.loading,className:"w-full inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",renderId:"render-20152a72",as:"button",children:[e.jsx(q,{size:16,className:"mr-2"}),j.loading?"Güncelleniyor...":"Güncelle"]})})]})]})]})})]})}if(typeof window<"u"){const u={};globalThis.process??={};const n=globalThis.process.env??{};globalThis.process.env=new Proxy(Object.assign({},u,n),{get(s,o){return o in s?s[o]:void 0},has(){return!0}})}const ce=S(function(n){const s=z();return e.jsx(T,{children:e.jsx(O,{children:e.jsx(R,{...n,id:s.id})})})});export{ce as default};
